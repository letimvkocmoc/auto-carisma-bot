<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../static/styles.css">
    <title>Auto Carisma</title>
</head>
<header>
    <img src="../static/images/logo.jpg" alt="–õ–æ–≥–æ" width="400" height="auto">
</header>
<div class="main">
    <div class="deliner"></div>
    <div class="menu">
        <a href="./orders" class="button">–ó–∞—è–≤–∫–∏</a>
    </div>
    <div class="deliner"></div>
    <div class="calculator-form-main">
        <div class="new-order-form">
            <table class="new_order_table">
                <tbody>
                <tr>
                    <td>–ò–º—è</td>
                    <td>
                        <input type="text" id="client_first_name">
                    </td>
                </tr>
                <tr>
                    <td>–§–∞–º–∏–ª–∏—è</td>
                    <td>
                        <input type="text" id="client_last_name">
                    </td>
                </tr>
                <tr>
                    <td>Telegram ID</td>
                    <td>
                        <input type="text" id="client_id">
                    </td>
                </tr>
                <tr>
                    <td>–¢–µ–ª–µ—Ñ–æ–Ω</td>
                    <td>
                        <input type="text" id="client_phonenumber">
                    </td>
                </tr>
                <tr>
                    <td>–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ</td>
                    <td>
                        <input type="text" id="model_auto">
                    </td>
                </tr>
                <tr>
                    <td>–û—Ü–µ–Ω–∫–∞</td>
                    <td>
                        <input type="text" id="rating">
                    </td>
                </tr>
                <tr>
                    <td>–°—Ç–æ–∏–º–æ—Å—Ç—å</td>
                    <td>
                        <input type="text" id="auto_price">
                    </td>
                </tr>
                <tr>
                    <td>–°—Ç–∞—Ç—É—Å</td>
                    <td>
                        <select id="status">
                            <option value="–í –æ–±—Ä–∞–±–æ—Ç–∫–µ">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                            <option value="–ü–æ–¥–±–æ—Ä –∞–≤—Ç–æ">–ü–æ–¥–±–æ—Ä –∞–≤—Ç–æ</option>
                            <option value="–†–æ–∑—ã–≥—Ä—ã—à –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ">–†–æ–∑—ã–≥—Ä—ã—à –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω–µ</option>
                            <option value="–í –ø—É—Ç–∏">–í –ø—É—Ç–∏</option>
                            <option value="–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—Ç–∞–º–æ–∂–∫–∏">–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—Ç–∞–º–æ–∂–∫–∏</option>
                            <option value="–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ">–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>–§–æ—Ç–æ (—Å—Å—ã–ª–∫–∞)</td>
                    <td>
                        <input type="text" id="picture">
                    </td>
                </tr>
                <tr>
                    <td>–°—Å—ã–ª–∫–∞ –Ω–∞ –∞—É–∫—Ü–∏–æ–Ω</td>
                    <td>
                        <input type="text" id="link">
                    </td>
                </tr>
                <tr>
                    <td>–û–ø–ª–∞—á–µ–Ω</td>
                    <td>
                        <select id="is_paid">
                            <option value="1">–û–ø–ª–∞—á–µ–Ω</option>
                            <option value="0">–ù–µ –æ–ø–ª–∞—á–µ–Ω</option>
                        </select>
                    </td>
                </tr>
                </tbody>
            </table>
            <button>–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
        </div>
        <form class="calculator-form" action="/calculate" method="POST" id="calculator-form">
    <table class="calculator">
        <tbody>
            <tr>
                <td>–ê–≤—Ç–æ–º–æ–±–∏–ª—å –≤–≤–æ–∑–∏—Ç</td>
                <td>
                    <select name="owner">
                        <option value="1">–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ (–¥–ª—è –ª–∏—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)</option>
                        <option value="2">–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ (–¥–ª—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∏)</option>
                        <option value="3">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>–í–æ–∑—Ä–∞—Å—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—è</td>
                <td>
                    <select name="age">
                        <option value="0-3">–¥–æ 3 –ª–µ—Ç</option>
                        <option value="3-5">–æ—Ç 3 –¥–æ 5 –ª–µ—Ç</option>
                        <option value="5-7">–æ—Ç 5 –¥–æ 7 –ª–µ—Ç</option>
                        <option value="3">–±–æ–ª–µ–µ 7</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>–¢–∏–ø –¥–≤–∏–≥–∞—Ç–µ–ª—è</td>
                <td>
                    <select name="engine">
                        <option value="1">–ë–µ–Ω–∑–∏–Ω–æ–≤—ã–π</option>
                        <option value="2">–î–∏–∑–µ–ª—å–Ω—ã–π</option>
                        <option value="3">–ì–∏–±—Ä–∏–¥–Ω—ã–π</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>–ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è</td>
                <td>
                    <input type="text" name="power">
                    <select name="power_unit">
                        <option value="1">–õ–°</option>
                        <option value="2">–∫–í—Ç</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>–û–±—ä–µ–º –¥–≤–∏–≥–∞—Ç–µ–ª—è</td>
                <td>
                    <input type="text" name="value">
                    <span>—Å–º<sup>3</sup> (1 –ª = 1000 —Å–º<sup>3</sup>)</span>
                </td>
            </tr>
            <tr>
                <td>–°—Ç–æ–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è</td>
                <td>
                    <input type="text" name="price">
                    <select name="curr">
                        <option value="EUR">–ï–≤—Ä–æ</option>
                        <option value="USD">–î–æ–ª–ª–∞—Ä –°–®–ê</option>
                        <option value="JPY">–Ø–ø–æ–Ω—Å–∫–∞—è –ò–µ–Ω–∞</option>
                        <option value="CNY">–ö–∏—Ç–∞–π—Å–∫–∏–π –Æ–∞–Ω—å</option>
                    </select>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="notice">
        <span style="text-align: left; font-size: 12px; margin: 0px;">*—Ä–∞—Å—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Å —É—á–µ—Ç–æ–º —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –Ø–ø–æ–Ω–∏–∏</span><br><br>
    </div>
    <div class="currency">
        <span style="align-items: center">üá∫üá∏ 1 USD = {{ currency['currency']['USD'] }} ‚ÇΩ</span><br>
        <span style="align-items: center">&#127466;&#127482; 1 EUR = {{ currency['currency']['EUR'] }} ‚ÇΩ</span><br>
        <span style="align-items: center">üá™üá∫ 1 CNY = {{ currency['currency']['CNY'] }} ‚ÇΩ</span><br>
        <span style="align-items: center">üáØüáµ 1 JPY = {{ currency['currency']['JPY'] }} ‚ÇΩ</span><br><br>
    </div>
    <button type="button" onclick="submitForm()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
</form>
        <div id="result" class="result">
    <table class="result">
        <tbody>
            <tr>
                <td style="width: 200px;">–°–±–æ—Ä</td>
                <td id="sbor"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–ù–∞–ª–æ–≥</td>
                <td id="tax"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–ù–∞–ª–æ–≥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞</td>
                <td id="tax_k"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–°–±–æ—Ä —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏</td>
                <td id="util"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–°–±–æ—Ä —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–ª—å–∫—É–ª—è—Ü–∏—è</td>
                <td id="util_k"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–ò—Ç–æ–≥–æ</td>
                <td id="total"> </td>
            </tr>
            <tr>
                <td style="width: 200px;">–ò—Ç–æ–≥–æ 2</td>
                <td id="total2"> </td>
            </tr>
        </tbody>
    </table>
</div>
    </div>
</div>
<script>
    function submitForm() {
    var form = document.getElementById("calculator-form");
    var formData = new FormData(form);
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "/calculate", true);
    xhr.onreadystatechange = function () {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                document.getElementById("sbor").innerText = response.sbor;
                document.getElementById("tax").innerText = response.tax;
                document.getElementById("tax_k").innerHTML = response.tax_k;
                document.getElementById("util").innerText = response.util;
                document.getElementById("util_k").innerText = response.util_k;
                document.getElementById("total").innerText = response.total;
                document.getElementById("total2").innerText = response.total2;
            } else {
                console.error("Error:", xhr.statusText);
            }
        }
    };
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.send(JSON.stringify(Object.fromEntries(formData)));
}
</script>
<script>
    document.querySelector('button').addEventListener('click', function() {
        var isPaidValue = document.getElementById('is_paid').value === 'True'; // Convert to boolean
        var data = {
            client_first_name: document.getElementById('client_first_name').value,
            client_last_name: document.getElementById('client_last_name').value,
            client_id: document.getElementById('client_id').value,
            client_phonenumber: document.getElementById('client_phonenumber').value,
            model_auto: document.getElementById('model_auto').value,
            rating: document.getElementById('rating').value,
            auto_price: document.getElementById('auto_price').value,
            status: document.getElementById('status').value,
            picture: document.getElementById('picture').value,
            link: document.getElementById('link').value,
            is_paid: isPaidValue // Use boolean value
        };

        fetch('/create_order', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        }).then(response => {
            if (response.ok) {
                // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                console.log('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω');
                window.location.href = '/orders'; // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É /orders
            } else {
                // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑');
            }
        }).catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
        });
    });
</script>
<footer>
    <div class="footer">
        <span>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: korneev.dev</span>
    </div>
</footer>